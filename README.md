# 回归分析项目说明

## 项目结构

本项目包含5个独立的Python脚本文件：

1. **1_随机森林模型.py** - 随机森林回归模型
2. **2_XGBoost模型.py** - XGBoost回归模型
3. **3_LightGBM模型.py** - LightGBM回归模型
4. **4_神经网络模型.py** - 神经网络回归模型
5. **5_线性回归模型.py** - 基于最优模型的线性回归分析

## 数据预处理

### IQR极端值过滤

所有5个文件都包含了IQR（四分位距）方法来过滤目标变量（周期产量）中的极端值：

- 计算目标变量的第一四分位数（Q1）和第三四分位数（Q3）
- 计算IQR = Q3 - Q1
- 下界 = Q1 - 3 × IQR
- 上界 = Q3 + 3 × IQR
- 过滤掉超出[下界, 上界]范围的样本

## 运行顺序

### 第一步：运行前4个模型文件（任意顺序）

```
python 1_随机森林模型.py
python 2_XGBoost模型.py
python 3_LightGBM模型.py
python 4_神经网络模型.py
```

每个文件会输出：
- 模型评估结果CSV（MAE、R²、RMSE、尾部MAE）
- 最优超参数CSV
- 真实值与预测值对比图PNG
- Top10特征重要性图PNG
- 训练好的模型PKL文件

### 第二步：运行线性回归文件

```
python 5_线性回归模型.py
```

此文件会：
- 读取前4个模型的评估结果
- 根据MAE>尾部MAE>R²>RMSE的优先级选择最优模型
- 提取最优模型的Top12重要特征
- 进行数据增强（每个样本生成10个邻域样本）
- 训练线性回归模型
- 输出线性回归评估结果和系数

## 输出文件

### 结果表文件夹

- `随机森林评估结果.csv`
- `随机森林最优超参数.csv`
- `随机森林模型.pkl`
- `XGBoost评估结果.csv`
- `XGBoost最优超参数.csv`
- `XGBoost模型.pkl`
- `LightGBM评估结果.csv`
- `LightGBM最优超参数.csv`
- `LightGBM模型.pkl`
- `神经网络评估结果.csv`
- `神经网络最优超参数.csv`
- `神经网络模型.pkl`
- `标准化器.pkl`
- `线性回归评估结果.csv`
- `线性回归系数.csv`
- `最优模型信息.csv`

### 图片文件夹

- `随机森林真实值与预测值对比.png`
- `随机森林Top10特征重要性.png`
- `XGBoost真实值与预测值对比.png`
- `XGBoostTop10特征重要性.png`
- `LightGBM真实值与预测值对比.png`
- `LightGBMTop10特征重要性.png`
- `神经网络真实值与预测值对比.png`
- `神经网络Top10特征重要性.png`
- `线性回归预测值与真实值对比.png`

## 关键特性

1. **IQR极端值过滤**：自动过滤掉目标变量中的异常值
2. **网格搜索调参**：所有模型都使用GridSearchCV进行超参数优化
3. **尾部MAE**：专门计算目标变量后30%高值区间的MAE
4. **数据增强**：为线性回归模型生成邻域样本，增加训练数据
5. **自动模型选择**：根据多个指标自动选择最优模型


